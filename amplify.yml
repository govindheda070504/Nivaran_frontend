version: 1
frontend:
  appRoot: "frontend"

  phases:
    preBuild:
      commands:
        - "echo 'Starting preBuild'; pwd; ls -la"
        - "if [ -f package-lock.json ]; then npm ci; elif [ -f yarn.lock ]; then yarn install; else npm install; fi"
    build:
      commands:
        - "echo 'Starting build'; npm run build"
        - "if npm run | grep -q ' export'; then echo 'Detected export script â€” running export'; npm run export; fi"

  artifacts:
    # For SSR/ISR use .next. If you do a static export (next export) change to 'out'.
    baseDirectory: .next
    files:
      - "**/*"

  cache:
    paths:
      - node_modules/**/*